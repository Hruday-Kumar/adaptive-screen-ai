<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AdaptiveScreen AI - Smart Reader</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.4/socket.io.min.js"></script>
    <style>
        :root {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --accent: #3b82f6;
            --accent-glow: rgba(59, 130, 246, 0.3);
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --border: rgba(255,255,255,0.1);
        }
        
        [data-theme="light"] {
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --bg-tertiary: #e2e8f0;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --border: rgba(0,0,0,0.1);
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            transition: all 0.3s ease;
        }
        
        /* Reading Progress Bar */
        .reading-progress {
            position: fixed;
            top: 0;
            left: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent), #8b5cf6);
            width: 0%;
            z-index: 1000;
            transition: width 0.1s;
        }
        
        /* Header */
        .header {
            position: sticky;
            top: 0;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            padding: 12px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
            backdrop-filter: blur(10px);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 700;
            font-size: 16px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        .logo-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--accent), #8b5cf6);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .icon-btn {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            border: 1px solid var(--border);
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.2s;
        }
        
        .icon-btn:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }
        
        .icon-btn.active {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }
        
        /* Main Layout */
        .main-container {
            display: grid;
            grid-template-columns: 1fr 320px;
            min-height: calc(100vh - 65px);
        }
        
        .main-container.fullscreen {
            grid-template-columns: 1fr;
        }
        
        .main-container.fullscreen .sidebar {
            display: none;
        }
        
        /* Article Content */
        .content {
            padding: 48px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .article-meta {
            margin-bottom: 32px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        .article-category {
            display: inline-block;
            padding: 6px 12px;
            background: linear-gradient(135deg, var(--accent), #8b5cf6);
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            color: white;
            margin-bottom: 16px;
        }
        
        .article-title {
            font-size: 36px;
            font-weight: 700;
            line-height: 1.3;
            margin-bottom: 16px;
        }
        
        .article-info {
            display: flex;
            align-items: center;
            gap: 16px;
            color: var(--text-secondary);
            font-size: 14px;
        }
        
        .article-info span {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .article-body {
            line-height: 1.8;
            transition: font-size 0.3s ease;
        }
        
        .article-body p {
            margin-bottom: 24px;
        }
        
        .article-body p.focus-highlight {
            background: var(--accent-glow);
            padding: 16px;
            border-radius: 8px;
            border-left: 4px solid var(--accent);
        }
        
        /* Sidebar */
        .sidebar {
            background: var(--bg-secondary);
            border-left: 1px solid var(--border);
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow-y: auto;
            max-height: calc(100vh - 65px);
            position: sticky;
            top: 65px;
        }
        
        .widget {
            background: var(--bg-primary);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid var(--border);
        }
        
        .widget-title {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Comfort Gauge */
        .comfort-gauge {
            position: relative;
            width: 100%;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .gauge-circle {
            width: 140px;
            height: 140px;
            position: relative;
        }
        
        .gauge-bg {
            fill: none;
            stroke: var(--bg-tertiary);
            stroke-width: 12;
        }
        
        .gauge-fill {
            fill: none;
            stroke: var(--success);
            stroke-width: 12;
            stroke-linecap: round;
            stroke-dasharray: 283;
            stroke-dashoffset: 283;
            transform: rotate(-90deg);
            transform-origin: center;
            transition: stroke-dashoffset 0.5s ease, stroke 0.3s;
        }
        
        .gauge-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }
        
        .gauge-value {
            font-size: 32px;
            font-weight: 700;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        .gauge-label {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        /* Status Indicators */
        .status-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        .status-item {
            background: var(--bg-tertiary);
            padding: 12px;
            border-radius: 10px;
            text-align: center;
        }
        
        .status-icon {
            font-size: 20px;
            margin-bottom: 6px;
        }
        
        .status-icon.on { color: var(--success); }
        .status-icon.off { color: var(--danger); }
        
        .status-label {
            font-size: 11px;
            color: var(--text-secondary);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        /* Controls */
        .control-row {
            display: flex;
            gap: 8px;
        }
        
        .control-btn {
            flex: 1;
            padding: 14px;
            border-radius: 12px;
            border: none;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.2s;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        .btn-lock {
            background: var(--danger);
            color: white;
        }
        
        .btn-unlock {
            background: var(--success);
            color: white;
        }
        
        .btn-lock:hover { background: #dc2626; }
        .btn-unlock:hover { background: #059669; }
        
        /* Sliders */
        .slider-control {
            margin-bottom: 16px;
        }
        
        .slider-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 13px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        .slider-value {
            color: var(--accent);
            font-weight: 600;
        }
        
        input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: var(--bg-tertiary);
            -webkit-appearance: none;
            cursor: pointer;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--accent);
            cursor: pointer;
            box-shadow: 0 2px 6px var(--accent-glow);
        }
        
        /* Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .stat-item {
            text-align: center;
            padding: 12px 8px;
            background: var(--bg-tertiary);
            border-radius: 10px;
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: 700;
            color: var(--accent);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        .stat-label {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 4px;
        }
        
        /* Eye Fatigue Alert */
        .fatigue-alert {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: linear-gradient(135deg, var(--warning), #d97706);
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            z-index: 1000;
            opacity: 0;
            transition: all 0.4s ease;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        .fatigue-alert.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }
        
        .fatigue-alert i {
            font-size: 24px;
        }
        
        .alert-close {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            margin-left: 12px;
        }
        
        /* Keyboard Shortcuts Modal */
        .shortcuts-modal {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }
        
        .shortcuts-modal.show {
            display: flex;
        }
        
        .shortcuts-content {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 32px;
            max-width: 500px;
            width: 90%;
            border: 1px solid var(--border);
        }
        
        .shortcuts-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        .shortcut-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid var(--border);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        .shortcut-key {
            background: var(--bg-tertiary);
            padding: 4px 10px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 13px;
        }
        
        /* Content Library Modal */
        .library-modal {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }
        
        .library-modal.show {
            display: flex;
        }
        
        .library-content {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 32px;
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid var(--border);
        }
        
        .library-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 24px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        .article-card {
            background: var(--bg-primary);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            cursor: pointer;
            border: 1px solid var(--border);
            transition: all 0.2s;
        }
        
        .article-card:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
        }
        
        .article-card-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        .article-card-desc {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.5;
        }
        
        .article-card-meta {
            display: flex;
            gap: 16px;
            margin-top: 12px;
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        /* Fullscreen */
        .fullscreen .content {
            max-width: 900px;
            padding: 64px;
        }
        
        /* Responsive */
        @media (max-width: 900px) {
            .main-container {
                grid-template-columns: 1fr;
            }
            .sidebar {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Reading Progress -->
    <div class="reading-progress" id="readingProgress"></div>
    
    <!-- Header -->
    <header class="header">
        <div class="logo">
            <div class="logo-icon"><i class="fas fa-eye"></i></div>
            <span>AdaptiveScreen AI</span>
        </div>
        <div class="header-actions">
            <button class="icon-btn" id="libraryBtn" title="Content Library (L)">
                <i class="fas fa-book-open"></i>
            </button>
            <button class="icon-btn" id="themeBtn" title="Toggle Theme (T)">
                <i class="fas fa-moon"></i>
            </button>
            <button class="icon-btn" id="focusBtn" title="Focus Mode (F)">
                <i class="fas fa-crosshairs"></i>
            </button>
            <button class="icon-btn" id="fullscreenBtn" title="Fullscreen (Esc)">
                <i class="fas fa-expand"></i>
            </button>
            <button class="icon-btn" id="shortcutsBtn" title="Keyboard Shortcuts (?)">
                <i class="fas fa-keyboard"></i>
            </button>
            <button class="icon-btn" id="dashboardBtn" title="Dashboard">
                <i class="fas fa-chart-line"></i>
            </button>
            <button class="icon-btn" id="logoutBtn" title="Logout">
                <i class="fas fa-sign-out-alt"></i>
            </button>
        </div>
    </header>
    
    <!-- Main Content -->
    <div class="main-container" id="mainContainer">
        <!-- Article -->
        <main class="content">
            <article>
                <div class="article-meta">
                    <span class="article-category" id="articleCategory">Technology</span>
                    <h1 class="article-title" id="articleTitle">The Future of Human-Computer Interaction</h1>
                    <div class="article-info">
                        <span><i class="fas fa-user"></i> Dr. Sarah Chen</span>
                        <span><i class="fas fa-clock"></i> <span id="readTime">8 min read</span></span>
                        <span><i class="fas fa-calendar"></i> Dec 28, 2025</span>
                    </div>
                </div>
                
                <div class="article-body" id="articleBody">
                    <p>The evolution of human-computer interaction represents one of the most fascinating journeys in technological history. From the early days of punch cards to today's sophisticated eye-tracking systems, we have continuously sought ways to make our interactions with machines more natural and intuitive.</p>
                    
                    <p>Eye tracking technology, in particular, has emerged as a revolutionary advancement in this field. By monitoring where users look and how their eyes behave, systems can now adapt in real-time to provide optimal reading experiences. This represents a fundamental shift from static, one-size-fits-all interfaces to dynamic, personalized experiences.</p>
                    
                    <p>The science behind eye tracking involves sophisticated computer vision algorithms that can detect and interpret subtle eye movements. Modern systems use infrared sensors and high-speed cameras to track pupil position, gaze direction, and even emotional states through eye behavior patterns.</p>
                    
                    <p>One of the most promising applications is adaptive reading interfaces. These systems can detect when a reader is experiencing strain‚Äîthrough squinting, rapid blinking, or other indicators‚Äîand automatically adjust text size, contrast, and spacing to reduce fatigue. This is particularly valuable for extended reading sessions or users with visual impairments.</p>
                    
                    <p>Research has shown that optimal reading conditions vary significantly between individuals. Factors such as lighting conditions, distance from screen, and personal vision characteristics all play important roles. Adaptive systems that can account for these variables show remarkable improvements in reading speed and comprehension while reducing eye strain.</p>
                    
                    <p>The implications extend beyond simple convenience. For individuals with certain disabilities, eye-tracking interfaces can provide entirely new ways to interact with computers. Hands-free computing, eye-controlled navigation, and attention-based content adaptation are already becoming reality.</p>
                    
                    <p>Looking forward, we can expect even more sophisticated integration of biometric feedback into our daily computing experiences. The combination of eye tracking with other sensors‚Äîheart rate monitors, skin conductance sensors, and even brain-computer interfaces‚Äîwill create truly responsive computing environments that anticipate and adapt to our needs.</p>
                    
                    <p>The ethical considerations of such intimate monitoring are significant. As these systems become more prevalent, establishing clear guidelines around data privacy, consent, and user control will be essential. The goal should always be to empower users, not to exploit their biometric data.</p>
                    
                    <p>As we stand at this technological crossroads, the potential for positive impact is immense. By making digital experiences more accessible and less fatiguing, we can improve quality of life for billions of people who interact with screens daily. The future of human-computer interaction is not just about what computers can do‚Äîit's about how seamlessly they can integrate into our lives.</p>
                </div>
            </article>
        </main>
        
        <!-- Sidebar -->
        <aside class="sidebar">
            <!-- Comfort Gauge -->
            <div class="widget">
                <div class="widget-title">üëÅÔ∏è Eye Comfort Score</div>
                <div class="comfort-gauge">
                    <div class="gauge-circle">
                        <svg viewBox="0 0 100 100">
                            <circle class="gauge-bg" cx="50" cy="50" r="45"/>
                            <circle class="gauge-fill" id="gaugeFill" cx="50" cy="50" r="45"/>
                        </svg>
                        <div class="gauge-text">
                            <div class="gauge-value" id="comfortScore">--</div>
                            <div class="gauge-label">Comfort</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Status -->
            <div class="widget">
                <div class="widget-title">üìä Status</div>
                <div class="status-grid">
                    <div class="status-item">
                        <div class="status-icon off" id="cameraIcon"><i class="fas fa-video"></i></div>
                        <div class="status-label">Camera</div>
                    </div>
                    <div class="status-item">
                        <div class="status-icon off" id="trackingIcon"><i class="fas fa-bullseye"></i></div>
                        <div class="status-label">Tracking</div>
                    </div>
                    <div class="status-item">
                        <div class="status-icon off" id="faceIcon"><i class="fas fa-user"></i></div>
                        <div class="status-label">Face</div>
                    </div>
                    <div class="status-item">
                        <div class="status-icon" id="modeIcon"><i class="fas fa-unlock"></i></div>
                        <div class="status-label" id="modeLabel">Adaptive</div>
                    </div>
                </div>
            </div>
            
            <!-- Main Control -->
            <div class="widget">
                <div class="widget-title">üéõÔ∏è Adaptive Control</div>
                <div class="control-row">
                    <button class="control-btn btn-unlock" id="adaptiveBtn">
                        <i class="fas fa-magic"></i> Adaptive
                    </button>
                    <button class="control-btn btn-lock" id="lockBtn">
                        <i class="fas fa-lock"></i> Lock
                    </button>
                </div>
            </div>
            
            <!-- Display Settings -->
            <div class="widget">
                <div class="widget-title">‚öôÔ∏è Display Settings</div>
                
                <div class="slider-control">
                    <div class="slider-header">
                        <span>Font Size</span>
                        <span class="slider-value" id="fontSizeValue">24px</span>
                    </div>
                    <input type="range" id="fontSlider" min="14" max="48" value="24">
                </div>
                
                <div class="slider-control">
                    <div class="slider-header">
                        <span>Line Height</span>
                        <span class="slider-value" id="lineHeightValue">1.8</span>
                    </div>
                    <input type="range" id="lineSlider" min="12" max="28" value="18" step="1">
                </div>
                
                <div class="slider-control">
                    <div class="slider-header">
                        <span>Brightness</span>
                        <span class="slider-value" id="brightnessValue">100%</span>
                    </div>
                    <input type="range" id="brightnessSlider" min="50" max="100" value="100">
                </div>
                
                <div class="slider-control">
                    <div class="slider-header">
                        <span>Sensitivity</span>
                        <span class="slider-value" id="sensitivityValue">5</span>
                    </div>
                    <input type="range" id="sensitivitySlider" min="1" max="10" value="5">
                </div>
            </div>
            
            <!-- Session Stats -->
            <div class="widget">
                <div class="widget-title">üìà Session Stats</div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="sessionTime">0:00</div>
                        <div class="stat-label">Time</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="avgFont">--</div>
                        <div class="stat-label">Avg Font</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="adjustments">0</div>
                        <div class="stat-label">Adjustments</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="strainEvents">0</div>
                        <div class="stat-label">Strain Events</div>
                    </div>
                </div>
            </div>
        </aside>
    </div>
    
    <!-- Eye Fatigue Alert -->
    <div class="fatigue-alert" id="fatigueAlert">
        <i class="fas fa-exclamation-triangle"></i>
        <div>
            <strong>Eye Strain Detected!</strong><br>
            <small>Consider taking a short break.</small>
        </div>
        <button class="alert-close" onclick="dismissAlert()">Got it</button>
    </div>
    
    <!-- Keyboard Shortcuts Modal -->
    <div class="shortcuts-modal" id="shortcutsModal">
        <div class="shortcuts-content">
            <div class="shortcuts-title">
                <span>‚å®Ô∏è Keyboard Shortcuts</span>
                <button class="icon-btn" onclick="toggleShortcuts()"><i class="fas fa-times"></i></button>
            </div>
            <div class="shortcut-row">
                <span>Toggle Theme</span>
                <span class="shortcut-key">T</span>
            </div>
            <div class="shortcut-row">
                <span>Focus Mode</span>
                <span class="shortcut-key">F</span>
            </div>
            <div class="shortcut-row">
                <span>Fullscreen</span>
                <span class="shortcut-key">Esc</span>
            </div>
            <div class="shortcut-row">
                <span>Content Library</span>
                <span class="shortcut-key">L</span>
            </div>
            <div class="shortcut-row">
                <span>Lock/Unlock</span>
                <span class="shortcut-key">Space</span>
            </div>
            <div class="shortcut-row">
                <span>Increase Font</span>
                <span class="shortcut-key">+</span>
            </div>
            <div class="shortcut-row">
                <span>Decrease Font</span>
                <span class="shortcut-key">-</span>
            </div>
        </div>
    </div>
    
    <!-- Content Library Modal -->
    <div class="library-modal" id="libraryModal">
        <div class="library-content">
            <div class="shortcuts-title">
                <span>üìö Content Library</span>
                <button class="icon-btn" onclick="toggleLibrary()"><i class="fas fa-times"></i></button>
            </div>
            
            <div class="article-card" onclick="loadArticle('tech')">
                <div class="article-card-title">The Future of Human-Computer Interaction</div>
                <div class="article-card-desc">Exploring eye tracking technology and adaptive interfaces that respond to human behavior.</div>
                <div class="article-card-meta">
                    <span><i class="fas fa-tag"></i> Technology</span>
                    <span><i class="fas fa-clock"></i> 8 min read</span>
                </div>
            </div>
            
            <div class="article-card" onclick="loadArticle('science')">
                <div class="article-card-title">The Mysteries of Deep Ocean Life</div>
                <div class="article-card-desc">Journey into the abyss where strange creatures thrive in complete darkness.</div>
                <div class="article-card-meta">
                    <span><i class="fas fa-tag"></i> Science</span>
                    <span><i class="fas fa-clock"></i> 10 min read</span>
                </div>
            </div>
            
            <div class="article-card" onclick="loadArticle('health')">
                <div class="article-card-title">The Science of Healthy Sleep</div>
                <div class="article-card-desc">Understanding sleep cycles and how to optimize your rest for better health.</div>
                <div class="article-card-meta">
                    <span><i class="fas fa-tag"></i> Health</span>
                    <span><i class="fas fa-clock"></i> 6 min read</span>
                </div>
            </div>
            
            <div class="article-card" onclick="loadArticle('history')">
                <div class="article-card-title">Ancient Civilizations and Their Innovations</div>
                <div class="article-card-desc">Remarkable achievements of ancient peoples that shaped our modern world.</div>
                <div class="article-card-meta">
                    <span><i class="fas fa-tag"></i> History</span>
                    <span><i class="fas fa-clock"></i> 12 min read</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============ STATE ============
        let socket = null;
        let isLocked = false;
        let focusMode = false;
        let sessionStart = Date.now();
        let adjustmentCount = 0;
        let strainEventCount = 0;
        let fontSizes = [];
        let lastFontSize = 24;
        let sensitivity = 5;
        
        // ============ ARTICLES DATABASE ============
        const articles = {
            tech: {
                category: 'Technology',
                title: 'The Future of Human-Computer Interaction',
                author: 'Dr. Sarah Chen',
                readTime: '8 min read',
                content: `<p>The evolution of human-computer interaction represents one of the most fascinating journeys in technological history. From the early days of punch cards to today's sophisticated eye-tracking systems, we have continuously sought ways to make our interactions with machines more natural and intuitive.</p>
                
                <p>Eye tracking technology, in particular, has emerged as a revolutionary advancement in this field. By monitoring where users look and how their eyes behave, systems can now adapt in real-time to provide optimal reading experiences. This represents a fundamental shift from static, one-size-fits-all interfaces to dynamic, personalized experiences.</p>
                
                <p>The science behind eye tracking involves sophisticated computer vision algorithms that can detect and interpret subtle eye movements. Modern systems use infrared sensors and high-speed cameras to track pupil position, gaze direction, and even emotional states through eye behavior patterns.</p>
                
                <p>One of the most promising applications is adaptive reading interfaces. These systems can detect when a reader is experiencing strain‚Äîthrough squinting, rapid blinking, or other indicators‚Äîand automatically adjust text size, contrast, and spacing to reduce fatigue. This is particularly valuable for extended reading sessions or users with visual impairments.</p>
                
                <p>Research has shown that optimal reading conditions vary significantly between individuals. Factors such as lighting conditions, distance from screen, and personal vision characteristics all play important roles. Adaptive systems that can account for these variables show remarkable improvements in reading speed and comprehension while reducing eye strain.</p>
                
                <p>The implications extend beyond simple convenience. For individuals with certain disabilities, eye-tracking interfaces can provide entirely new ways to interact with computers. Hands-free computing, eye-controlled navigation, and attention-based content adaptation are already becoming reality.</p>
                
                <p>Looking forward, we can expect even more sophisticated integration of biometric feedback into our daily computing experiences. The combination of eye tracking with other sensors‚Äîheart rate monitors, skin conductance sensors, and even brain-computer interfaces‚Äîwill create truly responsive computing environments that anticipate and adapt to our needs.</p>
                
                <p>The ethical considerations of such intimate monitoring are significant. As these systems become more prevalent, establishing clear guidelines around data privacy, consent, and user control will be essential. The goal should always be to empower users, not to exploit their biometric data.</p>
                
                <p>As we stand at this technological crossroads, the potential for positive impact is immense. By making digital experiences more accessible and less fatiguing, we can improve quality of life for billions of people who interact with screens daily. The future of human-computer interaction is not just about what computers can do‚Äîit's about how seamlessly they can integrate into our lives.</p>`
            },
            science: {
                category: 'Science',
                title: 'The Mysteries of Deep Ocean Life',
                author: 'Dr. James Morrison',
                readTime: '10 min read',
                content: `<p>Beneath the surface of our vast oceans lies a world so alien and mysterious that scientists often compare exploring it to discovering life on another planet. The deep ocean, defined as waters below 200 meters where sunlight cannot penetrate, covers more than 65% of Earth's surface yet remains largely unexplored.</p>
                
                <p>In these eternal depths, where crushing pressures exceed anything humans can withstand unprotected, life has found remarkable ways to thrive. Bioluminescence‚Äîthe ability to produce light through chemical reactions‚Äîis perhaps the most spectacular adaptation. An estimated 90% of deep-sea creatures possess this ability, creating an underwater light show invisible to surface dwellers.</p>
                
                <p>The anglerfish, with its terrifying appearance and dangling bioluminescent lure, has become an icon of deep-sea strangeness. But the diversity of life below extends far beyond familiar creatures. Giant isopods, resembling oversized pill bugs, scavenge on the ocean floor. Vampire squid, despite their name, feed on marine snow‚Äîa constant shower of organic debris from above.</p>
                
                <p>Hydrothermal vents, discovered only in 1977, revolutionized our understanding of life's possibilities. These underwater volcanic features spew superheated water rich in minerals, supporting ecosystems entirely independent of sunlight. Tube worms, crabs, and unique bacteria form communities around these vents, surviving on chemosynthesis rather than photosynthesis.</p>
                
                <p>The pressure at great depths is almost incomprehensible. At the bottom of the Mariana Trench, nearly 11,000 meters down, pressure reaches 1,086 bars‚Äîover a thousand times atmospheric pressure at sea level. Yet even here, life persists. In 2019, scientists discovered a new species of snailfish at 8,000 meters, proving life's resilience in extreme conditions.</p>
                
                <p>Deep-sea creatures have evolved numerous adaptations beyond bioluminescence. Many have enormous eyes to capture any available light, while others have lost their eyes entirely. Some fish have expandable stomachs allowing them to consume prey larger than themselves‚Äîa crucial adaptation where meals are rare and unpredictable.</p>
                
                <p>The scientific value of deep-sea research extends beyond marine biology. These environments offer insights into the origins of life, the potential for extraterrestrial life, and sources of novel compounds for medicine. Deep-sea sponges have yielded compounds with anti-cancer properties, and extremophile bacteria provide enzymes useful in biotechnology.</p>
                
                <p>However, the deep ocean faces threats from human activity. Deep-sea mining for rare minerals threatens fragile ecosystems that take centuries to recover. Climate change affects deep currents and oxygen levels, with potentially devastating consequences for communities adapted to stable conditions over millions of years.</p>
                
                <p>As technology advances, our ability to explore and understand these depths improves. Remotely operated vehicles and advanced submersibles continue to reveal new species and phenomena. Yet for every question answered, dozens more emerge. The deep ocean remains Earth's final frontier‚Äîa reminder that our planet still holds countless secrets waiting to be discovered.</p>`
            },
            health: {
                category: 'Health',
                title: 'The Science of Healthy Sleep',
                author: 'Dr. Emily Watson',
                readTime: '6 min read',
                content: `<p>Sleep is one of the most fundamental aspects of human health, yet it remains one of the most neglected. In our modern, always-connected world, quality sleep has become increasingly elusive, with profound consequences for physical and mental wellbeing.</p>
                
                <p>Understanding sleep begins with understanding its architecture. A typical night's sleep consists of 4-6 cycles, each lasting approximately 90 minutes. Within each cycle, we progress through different stages: light sleep, deep sleep, and REM (Rapid Eye Movement) sleep. Each stage serves distinct biological functions.</p>
                
                <p>Deep sleep, occurring primarily in the first half of the night, is when the body performs its most intensive repair work. Growth hormone is released, tissues are regenerated, and the immune system is strengthened. Missing deep sleep can leave you feeling physically unrestored, no matter how many total hours you spend in bed.</p>
                
                <p>REM sleep, when most dreaming occurs, plays a crucial role in cognitive function. During REM, the brain consolidates memories, processes emotions, and clears metabolic waste. Research has linked REM deprivation to difficulty concentrating, emotional instability, and increased risk of mental health disorders.</p>
                
                <p>The circadian rhythm‚Äîour internal 24-hour clock‚Äîgoverns sleep timing and quality. This biological clock responds primarily to light exposure, signaling wakefulness in bright conditions and sleepiness in darkness. Modern artificial lighting, especially the blue light from screens, can disrupt this ancient system.</p>
                
                <p>Sleep hygiene refers to practices that promote consistent, quality sleep. Key recommendations include maintaining a regular sleep schedule, creating a cool and dark sleeping environment, limiting caffeine after noon, and establishing a relaxing pre-sleep routine. Even small improvements in these areas can yield significant benefits.</p>
                
                <p>The consequences of chronic sleep deprivation extend far beyond daytime drowsiness. Poor sleep is associated with increased risk of obesity, diabetes, cardiovascular disease, and weakened immunity. Cognitively, sleep-deprived individuals show impairments comparable to intoxication.</p>
                
                <p>Recent research has revealed sleep's role in brain health and longevity. During sleep, the glymphatic system‚Äîthe brain's waste clearance mechanism‚Äîbecomes highly active, removing toxic proteins associated with Alzheimer's disease. This discovery has sparked new interest in sleep as a potential intervention for neurodegenerative conditions.</p>
                
                <p>Improving sleep is not about simply spending more time in bed. Quality matters as much as quantity. Addressing sleep disorders like insomnia or sleep apnea, managing stress, and creating optimal conditions for rest can transform how you feel and function. In our productivity-focused culture, it's time to recognize that sleep is not a luxury‚Äîit's a biological necessity.</p>`
            },
            history: {
                category: 'History',
                title: 'Ancient Civilizations and Their Innovations',
                author: 'Prof. Michael Torres',
                readTime: '12 min read',
                content: `<p>The technological achievements of ancient civilizations continue to astound modern researchers. Far from being primitive, our ancestors developed sophisticated solutions to complex problems‚Äîinnovations that in many cases laid the groundwork for technologies we use today.</p>
                
                <p>Ancient Egypt's engineering prowess is perhaps best exemplified by the pyramids. The Great Pyramid of Giza, built around 2560 BCE, remained the world's tallest structure for nearly 4,000 years. Constructing it required moving over 2 million limestone blocks, some weighing up to 80 tons, with precision that modern engineers still marvel at.</p>
                
                <p>But Egyptian innovation extended beyond monumental architecture. They developed one of the earliest writing systems, created sophisticated medical treatments documented in papyri that influenced medicine for centuries, and invented technologies like papyrus paper and water clocks. Their understanding of astronomy led to a calendar system remarkably close to our modern one.</p>
                
                <p>The Romans transformed the ancient world through engineering and organization. Their concrete, developed over 2,000 years ago, has proven more durable than many modern formulations‚ÄîRoman structures like the Pantheon still stand today. The Roman road network, spanning 80,000 kilometers, facilitated trade and communication across three continents.</p>
                
                <p>Roman aqueducts demonstrated mastery of hydraulic engineering. Using only gravity and precisely calculated gradients, they transported water over vast distances to cities throughout the empire. Some of these systems remained in use for centuries after Rome's fall, and their principles inform modern water infrastructure design.</p>
                
                <p>Ancient China contributed innovations that would eventually transform the world. Papermaking, printing, gunpowder, and the magnetic compass‚Äîthe Four Great Inventions‚Äîeach had revolutionary impacts. Chinese metallurgists produced cast iron a millennium before Europe, and their civil engineering included the Great Wall and the Grand Canal, still the world's longest artificial waterway.</p>
                
                <p>The Greeks laid foundations for Western science and philosophy, but their practical innovations were equally impressive. The Antikythera mechanism, discovered in a shipwreck and dated to around 100 BCE, is considered the world's first analog computer‚Äîa sophisticated device that predicted astronomical positions and eclipses with remarkable accuracy.</p>
                
                <p>In the Americas, the Maya developed an advanced mathematical system including the concept of zero, created accurate astronomical observations, and built elaborate cities with sophisticated urban planning. The Inca, without a writing system, managed a vast empire through quipus‚Äîcomplex arrangements of knotted strings that encoded information.</p>
                
                <p>Ancient Mesopotamia, often called the cradle of civilization, gave us writing, the wheel, and early forms of agriculture and urban planning. The Babylonians developed mathematical systems still used today, including the 60-second minute and 360-degree circle.</p>
                
                <p>These achievements remind us that innovation is not linear. Ancient peoples solved problems with available resources in ways that often demonstrated deeper understanding than we might assume. Studying their solutions continues to inspire modern researchers and engineers, proving that wisdom and ingenuity are timeless human qualities.</p>`
            }
        };
        
        // ============ INITIALIZATION ============
        document.addEventListener('DOMContentLoaded', () => {
            initSocket();
            initEventListeners();
            updateSessionTime();
            setInterval(updateSessionTime, 1000);
            
            // Start adaptive by default
            setTimeout(() => {
                if (!isLocked) startAdaptive();
            }, 500);
        });
        
        function initSocket() {
            socket = io();
            
            socket.on('connect', () => {
                console.log('‚úÖ Connected to server');
            });
            
            socket.on('state_update', (state) => {
                if (!isLocked) {
                    applyState(state);
                }
            });
            
            socket.on('disconnect', () => {
                console.log('‚ùå Disconnected');
            });
        }
        
        function initEventListeners() {
            // Control buttons
            document.getElementById('adaptiveBtn').addEventListener('click', startAdaptive);
            document.getElementById('lockBtn').addEventListener('click', lockSettings);
            
            // Header buttons
            document.getElementById('themeBtn').addEventListener('click', toggleTheme);
            document.getElementById('focusBtn').addEventListener('click', toggleFocus);
            document.getElementById('fullscreenBtn').addEventListener('click', toggleFullscreen);
            document.getElementById('shortcutsBtn').addEventListener('click', toggleShortcuts);
            document.getElementById('libraryBtn').addEventListener('click', toggleLibrary);
            document.getElementById('dashboardBtn').addEventListener('click', () => window.location.href = '/dashboard');
            document.getElementById('logoutBtn').addEventListener('click', logout);
            
            // Sliders
            document.getElementById('fontSlider').addEventListener('input', (e) => {
                setFontSize(parseInt(e.target.value));
            });
            
            document.getElementById('lineSlider').addEventListener('input', (e) => {
                const value = parseFloat(e.target.value) / 10;
                document.getElementById('articleBody').style.lineHeight = value;
                document.getElementById('lineHeightValue').textContent = value.toFixed(1);
            });
            
            document.getElementById('brightnessSlider').addEventListener('input', (e) => {
                const value = parseInt(e.target.value);
                document.body.style.filter = `brightness(${value}%)`;
                document.getElementById('brightnessValue').textContent = value + '%';
            });
            
            document.getElementById('sensitivitySlider').addEventListener('input', (e) => {
                sensitivity = parseInt(e.target.value);
                document.getElementById('sensitivityValue').textContent = sensitivity;
            });
            
            // Reading progress
            window.addEventListener('scroll', updateReadingProgress);
            
            // Keyboard shortcuts
            document.addEventListener('keydown', handleKeyboard);
        }
        
        // ============ CORE FUNCTIONS ============
        function applyState(state) {
            // Update status indicators
            updateStatus('cameraIcon', state.camera_on);
            updateStatus('trackingIcon', state.tracking);
            updateStatus('faceIcon', state.face_detected);
            
            // Calculate and apply font size
            if (state.face_detected && state.eye_openness > 0) {
                const fontSize = state.font_size || 24;
                
                // Track adjustments
                if (Math.abs(fontSize - lastFontSize) > 1) {
                    adjustmentCount++;
                    document.getElementById('adjustments').textContent = adjustmentCount;
                }
                lastFontSize = fontSize;
                fontSizes.push(fontSize);
                
                // Apply with sensitivity
                const targetSize = 24 + ((fontSize - 24) * (sensitivity / 5));
                setFontSize(Math.round(targetSize));
                
                // Update comfort score
                updateComfortScore(state.eye_openness);
                
                // Check for eye strain
                checkEyeStrain(state.eye_openness);
            }
        }
        
        function setFontSize(size) {
            size = Math.max(14, Math.min(48, size));
            const articleBody = document.getElementById('articleBody');
            if (articleBody) {
                articleBody.style.fontSize = size + 'px';
            }
            document.getElementById('fontSlider').value = size;
            document.getElementById('fontSizeValue').textContent = size + 'px';
            
            // Update average
            if (fontSizes.length > 0) {
                const avg = Math.round(fontSizes.reduce((a, b) => a + b) / fontSizes.length);
                document.getElementById('avgFont').textContent = avg + 'px';
            }
        }
        
        function updateStatus(id, isOn) {
            const el = document.getElementById(id);
            if (el) {
                el.classList.toggle('on', isOn);
                el.classList.toggle('off', !isOn);
            }
        }
        
        function updateComfortScore(eyeOpenness) {
            // Map eye openness to comfort score (0-100)
            const score = Math.min(100, Math.max(0, Math.round(eyeOpenness * 3)));
            
            document.getElementById('comfortScore').textContent = score;
            
            // Update gauge
            const gauge = document.getElementById('gaugeFill');
            const offset = 283 - (283 * score / 100);
            gauge.style.strokeDashoffset = offset;
            
            // Color based on score
            if (score >= 70) {
                gauge.style.stroke = 'var(--success)';
            } else if (score >= 40) {
                gauge.style.stroke = 'var(--warning)';
            } else {
                gauge.style.stroke = 'var(--danger)';
            }
        }
        
        function checkEyeStrain(eyeOpenness) {
            if (eyeOpenness < 15 && !isLocked) {
                strainEventCount++;
                document.getElementById('strainEvents').textContent = strainEventCount;
                
                // Show alert every 5 strain events
                if (strainEventCount % 5 === 0) {
                    showFatigueAlert();
                }
            }
        }
        
        // ============ CONTROL FUNCTIONS ============
        function startAdaptive() {
            isLocked = false;
            const articleTitle = document.getElementById('articleTitle').textContent || 'Unknown Article';
            socket.emit('start_tracking', { article: articleTitle });  // This handles both starting and unlocking
            
            document.getElementById('adaptiveBtn').classList.add('active');
            document.getElementById('lockBtn').classList.remove('active');
            document.getElementById('modeIcon').innerHTML = '<i class="fas fa-unlock"></i>';
            document.getElementById('modeLabel').textContent = 'Adaptive';
            
            console.log('üü¢ Adaptive mode enabled');
        }
        
        function lockSettings() {
            isLocked = true;
            socket.emit('lock');  // This handles both stopping and locking
            
            document.getElementById('lockBtn').classList.add('active');
            document.getElementById('adaptiveBtn').classList.remove('active');
            document.getElementById('modeIcon').innerHTML = '<i class="fas fa-lock"></i>';
            document.getElementById('modeLabel').textContent = 'Locked';
            
            // Update status to off
            updateStatus('cameraIcon', false);
            updateStatus('trackingIcon', false);
            
            console.log('üî¥ Locked - camera off');
        }
        
        // ============ UI FUNCTIONS ============
        function toggleTheme() {
            const html = document.documentElement;
            const btn = document.getElementById('themeBtn');
            const isDark = html.getAttribute('data-theme') === 'dark';
            
            html.setAttribute('data-theme', isDark ? 'light' : 'dark');
            btn.innerHTML = `<i class="fas fa-${isDark ? 'sun' : 'moon'}"></i>`;
            btn.classList.toggle('active', !isDark);
        }
        
        function toggleFocus() {
            focusMode = !focusMode;
            document.getElementById('focusBtn').classList.toggle('active', focusMode);
            
            if (focusMode) {
                highlightCurrentParagraph();
                window.addEventListener('scroll', highlightCurrentParagraph);
            } else {
                document.querySelectorAll('.focus-highlight').forEach(p => p.classList.remove('focus-highlight'));
                window.removeEventListener('scroll', highlightCurrentParagraph);
            }
        }
        
        function highlightCurrentParagraph() {
            const paragraphs = document.querySelectorAll('#articleBody p');
            const viewportCenter = window.innerHeight / 2;
            
            paragraphs.forEach(p => p.classList.remove('focus-highlight'));
            
            for (const p of paragraphs) {
                const rect = p.getBoundingClientRect();
                if (rect.top <= viewportCenter && rect.bottom >= viewportCenter) {
                    p.classList.add('focus-highlight');
                    break;
                }
            }
        }
        
        function toggleFullscreen() {
            const container = document.getElementById('mainContainer');
            const btn = document.getElementById('fullscreenBtn');
            const isFullscreen = container.classList.contains('fullscreen');
            
            container.classList.toggle('fullscreen');
            btn.innerHTML = `<i class="fas fa-${isFullscreen ? 'expand' : 'compress'}"></i>`;
            btn.classList.toggle('active', !isFullscreen);
        }
        
        function toggleShortcuts() {
            document.getElementById('shortcutsModal').classList.toggle('show');
        }
        
        function toggleLibrary() {
            document.getElementById('libraryModal').classList.toggle('show');
        }
        
        function loadArticle(articleId) {
            const article = articles[articleId];
            if (article) {
                document.getElementById('articleCategory').textContent = article.category;
                document.getElementById('articleTitle').textContent = article.title;
                document.getElementById('readTime').textContent = article.readTime;
                document.getElementById('articleBody').innerHTML = article.content;
                toggleLibrary();
                window.scrollTo(0, 0);
            }
        }
        
        function updateReadingProgress() {
            const docHeight = document.documentElement.scrollHeight - window.innerHeight;
            const scrolled = (window.scrollY / docHeight) * 100;
            document.getElementById('readingProgress').style.width = scrolled + '%';
        }
        
        function updateSessionTime() {
            const elapsed = Math.floor((Date.now() - sessionStart) / 1000);
            const mins = Math.floor(elapsed / 60);
            const secs = elapsed % 60;
            document.getElementById('sessionTime').textContent = `${mins}:${secs.toString().padStart(2, '0')}`;
        }
        
        function showFatigueAlert() {
            document.getElementById('fatigueAlert').classList.add('show');
        }
        
        function dismissAlert() {
            document.getElementById('fatigueAlert').classList.remove('show');
        }
        
        function handleKeyboard(e) {
            // Don't trigger in input fields
            if (e.target.tagName === 'INPUT') return;
            
            switch(e.key.toLowerCase()) {
                case 't': toggleTheme(); break;
                case 'f': toggleFocus(); break;
                case 'l': toggleLibrary(); break;
                case ' ': e.preventDefault(); isLocked ? startAdaptive() : lockSettings(); break;
                case '+': case '=': setFontSize(parseInt(document.getElementById('fontSlider').value) + 2); break;
                case '-': setFontSize(parseInt(document.getElementById('fontSlider').value) - 2); break;
                case 'escape': toggleFullscreen(); break;
                case '?': toggleShortcuts(); break;
            }
        }
        
        async function logout() {
            await fetch('/api/logout', { method: 'POST' });
            window.location.href = '/';
        }
    </script>
</body>
</html>
